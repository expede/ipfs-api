{-# OPTIONS_GHC -fno-warn-incomplete-uni-patterns #-}

module Fission.Internal.Fixture.Bearer
  ( jsonRSA2048
  , tokenRSA2048
  , jwtRSA2048
  , rawContent
  , validTime
  ) where

import           Servant.API

import           Fission.Prelude
import qualified Fission.Web.Auth.Token.Bearer.Types as Bearer
import           Fission.Web.Auth.Token.JWT

validTime :: UTCTime
validTime = fromSeconds 0 -- i.e. waaaay before the expiry :P

rawContent :: Text
rawContent = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsInVhdiI6IjAuMS4wIiwiY3R5IjoiSldUIn0.eyJhdWQiOiJkaWQ6a2V5OnpTdEVacHpTTXRUdDlrMnZzemd2Q3dGNGZMUVFTeUExNVc1QVE0ejNBUjZCeDRlRko1Y3JKRmJ1R3hLbWJtYTQiLCJleHAiOjk1ODc1NzcxNTIsIm5iZiI6MCwiaXNzIjoiZGlkOmtleTp6MVJpN1J5ZEN6czFUM1VyRk5zVnJ6cFIxeEg4YjVNb1lFMkJKU3dERExDZGhDd1pkak5TbkEzOEozeDZDWjNrRHB6bWc1ZUtyYXl1U0JGdjNDdVFDNERKV2VWM2JiYlRQYVFxOHhaTnpzVnVVaXRWZXBIWFdrYkpIejJEckFzUTJ4elZxMUNTZk5BNE1VU0ppc2UxdHhSQURGUmJlUVNqZEVYMVhqNnp6dUJjcnlVWmNoWG5WN2UzSFpCYmhXOUdTeExRa0hnNThIZGlmRllRdkFrQ2hqR3piV3JDQ0tYUUozZWFLb3FLYVlRTkRtTEE4Q2R0QmNrTHdvTlVqV3V4aXdOWG9xejRncEFrV2hnTERnRjlteGtwZEpKRUZGVzVZbjVkeXBIU2Nub2c3TGRabnc1WVFoUURUaGMxa0d1WlZBWG5RQzl2VnROelhQano3b2hHSGo2bjFxRms4czkzczlUd3pIZkUya3pGUHRhU1BmaW9FTG9jQk1pQkdmZ2ZwU2RKa3M1blpTRzgzeGRQejRXRThiNUtGQldadEhuVHNXQ3l3cHZOekFNTmVtbXZZbTJlTTZDZlBhYTZFVTExdVVuaVk5bzVHYm5VZ0NtMWtibWpkcEpuMVlqM0tIcGlGUGhxbVEyeVJ4QkVDa1ZaVThQRzdQZjZZNW4yWnQxTXdhQTdBR2FZV1I0TnQzV0JDZnUzR29ySEdqbTlzUTUiLCJwcmYiOm51bGwsInB0YyI6IkFQUEVORCIsInNjcCI6Ii8ifQ"

jsonRSA2048 :: Text
jsonRSA2048 = "Bearer " <> rawContent <> ".Sy8aEixUCMkS5c8Jl5r8dq8ariGJp1s1dv6jUIsHbADoXnk9xMxdAfVURlAQZx7hmIZms57nOoqrAOUN607pNYXabVA5I0vOMOb6j5pQOhQdo1yKo-mbDooX6825kRX2Pv563B2PK9ZpLCgOWwI0nMUI9MTVHbRshDLxHscP3JfR8Rw50ukovkBMFvdwEJiOCYPWk4PrGLoLzI1ffwPst15sTG2J8qjQ-zv1pWGk_D2n2zA7pKEykr37Kcr6rjzigiG5i89ffZFYuDy6fIB49X9YKPDVccoEGton1WTdN5y7XBoKn5OfxxPFZRJDvAkvA3LrkAK4kuM-FbToKcQKmg"

tokenRSA2048 :: Bearer.Token
jwtRSA2048   :: JWT

Right tokenRSA2048@(Bearer.Token jwtRSA2048 _) = parseUrlPiece jsonRSA2048
