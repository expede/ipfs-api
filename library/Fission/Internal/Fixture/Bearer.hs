{-# OPTIONS_GHC -fno-warn-incomplete-uni-patterns #-}

module Fission.Internal.Fixture.Bearer
  ( jsonRSA2048
  , tokenRSA2048
  , jwtRSA2048
  , rawContent
  , validTime
  ) where

import           Servant.API

import           Fission.Prelude
import qualified Fission.Web.Auth.Token.Bearer.Types as Bearer
import           Fission.Web.Auth.Token.JWT

validTime :: UTCTime
validTime = fromSeconds 0 -- i.e. waaaay before the expiry :P

rawContent :: Text
rawContent = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsInVhdiI6IjAuMS4wIn0.eyJpc3MiOiJkaWQ6a2V5OnoxMldWNEFRMUFXUG5DZks2SGlFd1NjNDRmUlVHZ21lVnQxUzltM2paMjhMaFFTVUFSS1E0Tm5oQk1uWEF5WVpZUzFuRFRhWW55SEdaRExSSm52ZFlzYjRIdzdrWG43YURuQVJLRXg4elp4c2dTN1BEZTVadnZCRVpXUXByUzdUY3Z0VHdMeWczd0Q1RndFUXdxcHBhRGNLa0tyeVRtQTZhZnZOd1pBODdOQVlYRlFnZldaMWhLdWNOOXppQzd3eGR3bVR5c1dSRXNZd0dzekZ5enVhNUxjckFCUExTUER1V0g2UUdIaGNzRmd0V214anZZcGcxNHpvUlBYUlNCcTNwaXhVUVRGM3VSNUozM0NOVUREbkFHWnlRRWV3WVExVkQ2eHdoWW1XNkVzQmJLR1FDQTMyNGZ3clBaRmo3UkMxZ1ZhSDJkeTg3MkVFY0xCS2tXN0VXVWNBUVpwZmdabjhNRUtzaHJHQVpqcnRkenhDdFpqcHAzN2lRMnhlU3VjQWs1a0hYeWtvZTJXYktmU3hqc1VIOTdQM0JNTjZrSERUdVFEOEE1N1oyeWU3emhyelBMYnpTV3o0VEtMbVdhbzJNQWJmeU14MUZrVU5lN0szNG9mckd1NnNjNUNzeG1DYm54Tk15anlRM2lSTjY1VDVveDZpM1FSRDNERFF6RUJxOEg4VDlaTUxFcE1ZeUpueUphajZwYm5UNHlQb2lDYnYxS3FkdnU5SG5KQmFmeEJaUVdKWURNWkFtVHpIdk50RmloOVFCRlk4RkpYdlMxb2l5M0JvUzE1cDNKUkJ5d2pGQkd5ZUt2Z3BpcThNWUF4RGdhSnVZS1Q5MnlzZjI1NjNwU2tYdmlNWDV1YUw2TlhQcGt2NXpvN01UVVFoOVNZV2Y0eTJ0NzVFcjk5UmZIUHVvYTV5UkpoRkg4OUM1TDI4UzQ1VmFqQ1dhQzUxcjVaUm54R0xYdWhWWUU3OXVzZVFjNG03YWpoRWZzcDdWUFVoR3AiLCJhdWQiOiJkaWQ6a2V5OnpCUjRtM0ROWkhUMUc4TmIyUkh6Z0tLN1RyV3hFbUpqWnNrZ3ZGZG5jVHRoelVIem5neU5LbUt4NFZLV0VKRTZzazRTRTRLYTNrSDkyTXhVMllDN0NjZVBIeTc3R3paeTgiLCJzdWIiOiJkaWQ6a2V5OnpCUjRtM0ROWkhUMUc4TmIyUkh6Z0tLN1RyV3hFbUpqWnNrZ3ZGZG5jVHRoelVIem5neU5LbUt4NFZLV0VKRTZzazRTRTRLYTNrSDkyTXhVMllDN0NjZVBIeTc3R3paeTgiLCJzY3AiOiIvIiwicCI6IkFQUEVORCIsImV4cCI6MjUxNjIzOTAyMn0"

jsonRSA2048 :: Text
jsonRSA2048 = "Bearer " <> rawContent <> ".iW4CaNGKHb3zHw32YP2lBnIIITgpzB_jbM-W_EbDDev2erNCwUmEf6wyu-vnkLZfSTK1mQV0jlsQtvsrd4IfnWIlYqK_61pmr-TZeScGmZVDITxcFOa3fHHGPqahvoPcTcMdOG9_PSFmsmosn-mbgOjHU-SOCLm9bnOSbntDUqNwjydT7dfXx5Vhx6CdsunxF77-xGKC2iTZFBGVEVK8ITFxsHQ-VwyfawX0liem2OG3B2Td0t63Q__3JBZ5f0XIasZh9Z-e-VrZGnumj7OfsipyYlQuomRStd7AWzz6VgKy_Vh2jnqD6Xw9a9H4lyxu4bUiaiCNkbSj9-XW90vj8Q"

tokenRSA2048 :: Bearer.Token
jwtRSA2048   :: JWT

Right tokenRSA2048@(Bearer.Token jwtRSA2048 _) = parseUrlPiece jsonRSA2048
