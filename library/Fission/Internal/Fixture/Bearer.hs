{-# OPTIONS_GHC -fno-warn-incomplete-uni-patterns #-}

module Fission.Internal.Fixture.Bearer
  ( jsonRSA2048
  , tokenRSA2048
  , jwtRSA2048
  , rawContent
  , validTime
  ) where

import           Servant.API

import           Fission.Prelude
import qualified Fission.Web.Auth.Token.Bearer.Types as Bearer
import           Fission.Web.Auth.Token.JWT

validTime :: UTCTime
validTime = fromSeconds 0 -- i.e. waaaay before the expiry :P

rawContent :: Text
rawContent = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJkaWQ6a2V5Ono0dDdmODFHb3pMQmJaUkRIVVFaQlRiUGNUVXBNZXUxc24xU0FuZ0xHR1B3U2plQmhXRmhKZTRvR2FWMWduZUFEMXR0Q3lYUUpMdGo2RUtFVWJZMTJWVHN2cUxCVDg5WjZyUXJGYlZxRHdMTFZCTjNTWTJoazhxNXNuNXdvbVJWaFZNcm45OE5LRFF6UWRKcENDd2FDMTJwRmFXZjF2cGhrOEdFb1JhQXM1WXRHR2h1RE1YZ1VBMzNzMVRFdENLdnpVTUd0S291aHZMRUpRZEN5cHRBY3Q2VVdpREdRVGdIc0pVQ1FYVnRIWnphZml2dzV5c24zVFIzSjFieHU5QVM2aVJwYXJWMzlNYVc1Y3JxY2drdUt2Zjc1SnRBcWZCSGlhRU5tVGpLendEZ0Y5OUR1d2pMY1RGZkJQUUpzcnFoc1NFQTdES2Y3VEptOUJ4WlhwR2pkVDEzOG5IN3AySkhXZUtzSnJ2NGh4ODc3VGRuZWlYUHo1U0duVmpDaVBEaWhrQldrOE50MXlMdmdKTGVCRGFXTkNYRnBFY3MyeEprblRIY2dzS2gxdlBpNXVMcGJ6QUZzZ0diUmRSUnJzd1plZFljSHRHM3l3c0dNQnZGcTNiTVN4QlZNV1ZIUXdoVERaUjJORWh0eXlLRlg4cmUxREM0RzRKTVNFaUVQRXNGc1p5QWo5a21NdU02OXc4eFJEQ1VEQ3pBRnkzbmN5Vmpha2VFTSIsInN1YiI6ImRpZDprZXk6ekJSNG0zRE5aSFQxRzhOYjJSSHpnS0s3VHJXeEVtSmpac2tndkZkbmNUdGh6VUh6bmd5TkttS3g0VktXRUpFNnNrNFNFNEthM2tIOTJNeFUyWUM3Q2NlUEh5NzdHelp5OCIsInByZiI6bnVsbCwic2NwIjoiLyIsInB0eSI6IkFQUEVORCIsImV4cCI6MjUxNjIzOTAyMn0" -- eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJkaWQ6a2V5Ono0dDdmODFHb3pMQmJaUkRIVVFaQlRiUGNUVXBNZXUxc24xU0FuZ0xHR1B3U2plQmhXRmhKZTRvR2FWMWduZUFEMXR0Q3lYUUpMdGo2RUtFVWJZMTJWVHN2cUxCVDg5WjZyUXJGYlZxRHdMTFZCTjNTWTJoazhxNXNuNXdvbVJWaFZNcm45OE5LRFF6UWRKcENDd2FDMTJwRmFXZjF2cGhrOEdFb1JhQXM1WXRHR2h1RE1YZ1VBMzNzMVRFdENLdnpVTUd0S291aHZMRUpRZEN5cHRBY3Q2VVdpREdRVGdIc0pVQ1FYVnRIWnphZml2dzV5c24zVFIzSjFieHU5QVM2aVJwYXJWMzlNYVc1Y3JxY2drdUt2Zjc1SnRBcWZCSGlhRU5tVGpLendEZ0Y5OUR1d2pMY1RGZkJQUUpzcnFoc1NFQTdES2Y3VEptOUJ4WlhwR2pkVDEzOG5IN3AySkhXZUtzSnJ2NGh4ODc3VGRuZWlYUHo1U0duVmpDaVBEaWhrQldrOE50MXlMdmdKTGVCRGFXTkNYRnBFY3MyeEprblRIY2dzS2gxdlBpNXVMcGJ6QUZzZ0diUmRSUnJzd1plZFljSHRHM3l3c0dNQnZGcTNiTVN4QlZNV1ZIUXdoVERaUjJORWh0eXlLRlg4cmUxREM0RzRKTVNFaUVQRXNGc1p5QWo5a21NdU02OXc4eFJEQ1VEQ3pBRnkzbmN5Vmpha2VFTSIsInN1YiI6ImRpZDprZXk6ekJSNG0zRE5aSFQxRzhOYjJSSHpnS0s3VHJXeEVtSmpac2tndkZkbmNUdGh6VUh6bmd5TkttS3g0VktXRUpFNnNrNFNFNEthM2tIOTJNeFUyWUM3Q2NlUEh5NzdHelp5OCIsInByZiI6bnVsbCwic2N5IjoiLyIsInB0eSI6IkFQUEVORCIsImV4cCI6MjUxNjIzOTAyMn0"

jsonRSA2048 :: Text
jsonRSA2048 = "Bearer " <> rawContent <> ".QMuiFSDwN0C3-7ITQs8e3TJctq3lB2yHgB6NkMvMTWCQSVCxL0aIxryH_XOujJtFeCaalpIo0hi_dkN-zgyia9iK526Uou-FQfPmYvbiUuOyA4Vfx87tEi5ygw-HMf67GT-QpLaWyiih-xBgwAbDEs9MbolJd9YiITMlsS06bFyIVw0M0Fgbh5h5WxGOZ_FcJdpE6iSsabTx-N8ov_-exH5wbyvt3rmoStesu_ODFow0K2O-SdB2cqhBNunogeZPWzKnYdcC-mPMXKrqaVTcdWI3cutrYe1CYIsYLoQlUcX6WCTj9G7fVg_iqwv-TUa0PW8dnqckepqVjd9Wqr2zEw"

tokenRSA2048 :: Bearer.Token
jwtRSA2048   :: JWT

Right tokenRSA2048@(Bearer.Token jwtRSA2048 _) = parseUrlPiece jsonRSA2048

-- {
--   "iss": "did:key:z4t7f81GozLBbZRDHUQZBTbPcTUpMeu1sn1SAngLGGPwSjeBhWFhJe4oGaV1gneAD1ttCyXQJLtj6EKEUbY12VTsvqLBT89Z6rQrFbVqDwLLVBN3SY2hk8q5sn5womRVhVMrn98NKDQzQdJpCCwaC12pFaWf1vphk8GEoRaAs5YtGGhuDMXgUA33s1TEtCKvzUMGtKouhvLEJQdCyptAct6UWiDGQTgHsJUCQXVtHZzafivw5ysn3TR3J1bxu9AS6iRparV39MaW5crqcgkuKvf75JtAqfBHiaENmTjKzwDgF99DuwjLcTFfBPQJsrqhsSEA7DKf7TJm9BxZXpGjdT138nH7p2JHWeKsJrv4hx877TdneiXPz5SGnVjCiPDihkBWk8Nt1yLvgJLeBDaWNCXFpEcs2xJknTHcgsKh1vPi5uLpbzAFsgGbRdRRrswZedYcHtG3ywsGMBvFq3bMSxBVMWVHQwhTDZR2NEhtyyKFX8re1DC4G4JMSEiEPEsFsZyAj9kmMuM69w8xRDCUDCzAFy3ncyVjakeEM"
--   "sub": "did:key:zBR4m3DNZHT1G8Nb2RHzgKK7TrWxEmJjZskgvFdncTthzUHzngyNKmKx4VKWEJE6sk4SE4Ka3kH92MxU2YC7CcePHy77GzZy8",
--   "prf": null,
--   "scy": "/",
--   "pty": "APPEND",
--   "exp": 2516239022
-- }
